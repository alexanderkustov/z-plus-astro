---
import BaseLayout from "../layouts/BaseLayout.astro";
import ZPlusLogo from "../components/ZPlusLogo.jsx";
---

<BaseLayout title="Z+ | Home">
  <section class="home-hero">
    <div class="hero-content">
      <div class="hero-logo-container">
        <p class="eyebrow static-eyebrow">Z+</p>
        <div class="animated-logo">
          <ZPlusLogo client:load />
        </div>
      </div>
      <h1>Global career acceleration for ambitious international talent.</h1>
      <p class="hero-lede">
        We design bespoke coaching, placement support, and business guidance
        that help you land elite opportunities in the UK and beyond.
      </p>
      <div class="hero-actions">
        <a class="button primary" href="/services">Explore services</a>
        <a class="button ghost" href="/case-studies">View success stories</a>
      </div>
    </div>
    <div class="hero-grid" aria-label="Highlights">
      <article>
        <h3>Offer-ready coaching</h3>
        <p>
          Structured plans, mock interviews, and recruiter insight to secure top
          roles.
        </p>
      </article>
      <article>
        <h3>Placement guarantee</h3>
        <p>
          Holiday internships matched to your goals with a proven success track
          record.
        </p>
      </article>
      <article>
        <h3>Founder advisory</h3>
        <p>
          Market entry guidance and operational support for overseas
          entrepreneurs.
        </p>
      </article>
    </div>
  </section>

  <section class="home-section">
    <h2>Where we make the difference</h2>
    <div class="focus-grid">
      <article>
        <h3>Career positioning</h3>
        <p>
          Define a compelling narrative and target roles that suit your
          long-term goals.
        </p>
      </article>
      <article>
        <h3>Elite preparation</h3>
        <p>
          Build confidence with personalized training across business,
          leadership, and delivery.
        </p>
      </article>
      <article>
        <h3>International network</h3>
        <p>
          Access mentors, alumni, and partners across high-growth sectors in the
          UK.
        </p>
      </article>
      <article>
        <h3>Outcome tracking</h3>
        <p>
          Stay accountable with progress dashboards, weekly check-ins, and
          milestone reviews.
        </p>
      </article>
      <div class="focus-plus" aria-hidden="true">+</div>
    </div>
  </section>

  <section class="home-section">
    <h2>Results that speak</h2>
    <div class="stat-grid">
      <article>
        <p class="stat">96%</p>
        <p class="stat-label">
          Clients secure internships or full-time offers within six months.
        </p>
      </article>
      <article>
        <p class="stat">120+</p>
        <p class="stat-label">
          Partners across finance, consulting, and technology.
        </p>
      </article>
      <article>
        <p class="stat">1:1</p>
        <p class="stat-label">
          Dedicated coaching with curated career roadmaps.
        </p>
      </article>
    </div>
  </section>

  <section class="home-section home-cta">
    <div>
      <h2>Ready to move faster?</h2>
      <p>
        Book a strategy session and we will map the exact steps from your
        current position to your next opportunity.
      </p>
    </div>
    <button class="button primary" type="button" data-modal-open="cta">
      Schedule a consultation
    </button>
    <dialog class="cta-modal" id="cta-modal" aria-labelledby="cta-modal-title">
      <form class="cta-modal__content" method="dialog">
        <div class="cta-modal__header">
          <div>
            <p class="cta-modal__eyebrow">Z+ Strategy Session</p>
            <h3 id="cta-modal-title">Tell us what you want to achieve.</h3>
          </div>
          <button
            class="cta-modal__close"
            type="button"
            data-modal-close
            aria-label="Close form"
          >
            âœ•
          </button>
        </div>
        <label class="cta-modal__field">
          Name
          <input
            type="text"
            name="name"
            autocomplete="name"
            placeholder="Your full name"
            required
          />
        </label>
        <label class="cta-modal__field">
          Email
          <input
            type="email"
            name="email"
            autocomplete="email"
            placeholder="you@email.com"
            required
          />
        </label>
        <label class="cta-modal__field">
          Goal
          <textarea
            name="goal"
            rows="3"
            placeholder="Share the role, sector, or milestone you want next."
            required
          ></textarea>
        </label>
        <p class="cta-modal__privacy">
          We only use your details to schedule this session and never share
          them without permission.
        </p>
        <div class="cta-modal__actions">
          <button class="button ghost" type="button" data-modal-close>
            Not now
          </button>
          <button class="button primary" type="submit">
            Request session
          </button>
        </div>
      </form>
    </dialog>
  </section>

  <script type="module">
    import {
      animate,
      inView,
      stagger,
    } from "https://cdn.jsdelivr.net/npm/motion@10.18.0/+esm";

    const prefersReducedMotion = window.matchMedia(
      "(prefers-reduced-motion: reduce)",
    ).matches;

    const h1 = document.querySelector(".hero-content h1");
    if (h1) {
      h1.addEventListener("mouseenter", () => {
        window.dispatchEvent(new Event("z-plus-rotate"));
      });
    }

    if (!prefersReducedMotion) {
      animate(
        ".home-hero .hero-content > *",
        { opacity: [0, 1], y: [18, 0] },
        { duration: 0.7, delay: stagger(0.1), easing: "ease-out" },
      );

      animate(
        ".home-hero .hero-grid article",
        { opacity: [0, 1], y: [20, 0] },
        {
          duration: 0.7,
          delay: stagger(0.12, { start: 0.25 }),
          easing: "ease-out",
        },
      );

      inView(
        ".home-section",
        (info) => {
          animate(
            info.target,
            { opacity: [0, 1], y: [24, 0] },
            { duration: 0.7, easing: "ease-out" },
          );
        },
        { margin: "-15% 0px", once: true },
      );
    }

    const modal = document.querySelector("#cta-modal");
    const openButton = document.querySelector("[data-modal-open='cta']");
    const closeButtons = modal?.querySelectorAll("[data-modal-close]") ?? [];
    const focusableSelectors =
      "a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex='-1'])";
    let lastFocusedElement;

    const getFocusable = () => {
      if (!modal) return [];
      return Array.from(modal.querySelectorAll(focusableSelectors)).filter(
        (element) =>
          !element.hasAttribute("disabled") &&
          element.getAttribute("tabindex") !== "-1",
      );
    };

    const openModal = () => {
      if (!modal) return;
      lastFocusedElement = document.activeElement;
      modal.showModal();
      const focusable = getFocusable();
      if (focusable.length > 0) {
        focusable[0].focus();
      } else {
        modal.focus();
      }
      document.body.style.overflow = "hidden";
    };

    const closeModal = () => {
      if (!modal) return;
      modal.close();
      document.body.style.overflow = "";
      if (lastFocusedElement instanceof HTMLElement) {
        lastFocusedElement.focus();
      }
    };

    if (openButton) {
      openButton.addEventListener("click", openModal);
    }

    closeButtons.forEach((button) => {
      button.addEventListener("click", closeModal);
    });

    modal?.addEventListener("click", (event) => {
      if (event.target === modal) {
        closeModal();
      }
    });

    modal?.addEventListener("close", () => {
      document.body.style.overflow = "";
    });

    modal?.addEventListener("keydown", (event) => {
      if (event.key !== "Tab") return;
      const focusable = getFocusable();
      if (focusable.length === 0) return;
      const first = focusable[0];
      const last = focusable[focusable.length - 1];
      if (event.shiftKey && document.activeElement === first) {
        event.preventDefault();
        last.focus();
      } else if (!event.shiftKey && document.activeElement === last) {
        event.preventDefault();
        first.focus();
      }
    });
  </script>
</BaseLayout>
